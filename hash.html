<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <script src="test-runner.js"></script>
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'none'; script-src 'nonce-s33kr1t' 'sha256-hqU7oyXxsHfG6gXGTnC29cbz85avp4sEdxbEexf583k='">

    <script src="legitimate-script.js" integrity="sha256-hqU7oyXxsHfG6gXGTnC29cbz85avp4sEdxbEexf583k="></script>
    <script type="text/javascript" nonce="s33kr1t">
        const integrity = [...document.getElementsByTagName('script')]
            .map(script => script.integrity)
            .find(val => val);
        const script = document.createElement('script');
        script.src = "bad-script.js"
        script.integrity = integrity;
        document.head.appendChild(script);</script>
</head>

<body>
</body>

</html>
